<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Basket - Mediterranean Sweets</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
    <header class="main-header">
        <div class="header-content">
            <div class="header-left">
                <a href="{{ url_for('index') }}" class="logo-link">
                    <img src="{{ url_for('static', filename='img/logo2.png') }}" alt="Mediterranean Sweets" class="logo">
                    <h1 class="brand-name">Jiji's Cakes & Deserts</h1>
                </a>
            </div>

            <nav class="nav-main">
                <div class="nav-links">
                    <a href="{{ url_for('index') }}" class="nav-link">ğŸ  Home</a>
                    <a href="{{ url_for('products') }}" class="nav-link">ğŸª Products</a>
                    <a href="{{ url_for('basket') }}" class="nav-link basket-link">
                        <span class="basket-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                <path d="M17,18A2,2 0 0,1 19,20A2,2 0 0,1 17,22C15.89,22 15,21.1 15,20C15,18.89 15.89,18 17,18M1,2H4.27L5.21,4H20A1,1 0 0,1 21,5C21,5.17 20.95,5.34 20.88,5.5L17.3,11.97C16.96,12.58 16.3,13 15.55,13H8.1L7.2,14.63L7.17,14.75A0.25,0.25 0 0,0 7,15.75V17H18V18H7L5,20H18C19,20 20,19 20,18H5.76L5.21,4H4.27L1,2ZM7,12C7,12 7.5,12.5 7,13C6.5,13.5 6,13 6,13C6,12.5 6.5,12 7,12Z"/>
                            </svg>
                            {% if basket_count > 0 %}
                            <span class="basket-count">{{ basket_count }}</span>
                            {% endif %}
                        </span>
                        Basket
                    </a>
                </div>

                <div class="nav-actions">
                    <button class="nav-action-btn" id="searchToggle" aria-label="Search">
                        ğŸ”
                    </button>

                    <div class="account-dropdown">
                        <button class="nav-action-btn" id="accountBtn" aria-label="Account">
                            ğŸ‘¤
                        </button>
                        <div class="dropdown-content">
                            <a href="#" class="dropdown-link">ğŸ‘¤ Profile</a>
                            <a href="#" class="dropdown-link">ğŸ“¦ Orders</a>
                            <a href="#" class="dropdown-link">â¤ï¸ Wishlist</a>
                            <a href="#" class="dropdown-link">ğŸ¯ Preferences</a>
                            <hr class="dropdown-divider">
                            <a href="#" class="dropdown-link">ğŸšª Logout</a>
                        </div>
                    </div>

                    <div class="lang-selector">
                        <button class="nav-action-btn" id="langBtn" aria-label="Language">
                            ğŸŒ EN
                        </button>
                        <div class="dropdown-content">
                            <a href="#" class="dropdown-link" data-lang="en">ğŸ‡ºğŸ‡¸ English</a>
                            <a href="#" class="dropdown-link" data-lang="ar">ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</a>
                            <a href="#" class="dropdown-link" data-lang="fr">ğŸ‡«ğŸ‡· FranÃ§ais</a>
                        </div>
                    </div>

                    <button class="nav-action-btn mobile-menu-toggle" id="menuToggle" aria-label="Menu">
                        â˜°
                    </button>
                </div>

                <div class="nav-search" id="navSearch">
                    <input type="text" placeholder="Search pastries..." class="search-input">
                    <button class="search-submit" type="submit">ğŸ”</button>
                </div>
            </nav>
        </div>

        <div class="mobile-menu" id="mobileMenu">
            <div class="mobile-menu-content">
                <button class="mobile-menu-close" id="mobileMenuClose">âœ•</button>
                <a href="{{ url_for('index') }}" class="mobile-menu-link">ğŸ  Home</a>
                <a href="{{ url_for('products') }}" class="mobile-menu-link">ğŸª Products</a>
                <a href="{{ url_for('basket') }}" class="mobile-menu-link">
                    <span class="basket-icon">
                        ğŸ›’
                        {% if basket_count > 0 %}
                        <span class="basket-count">{{ basket_count }}</span>
                        {% endif %}
                    </span>
                    Basket
                </a>

                <div class="mobile-menu-section">
                    <h3>Account</h3>
                    <a href="#" class="mobile-menu-link">ğŸ‘¤ Profile</a>
                    <a href="#" class="mobile-menu-link">ğŸ“¦ Orders</a>
                    <a href="#" class="mobile-menu-link">â¤ï¸ Wishlist</a>
                </div>

                <div class="mobile-menu-section">
                    <h3>Language</h3>
                    <a href="#" class="mobile-menu-link">ğŸ‡ºğŸ‡¸ English</a>
                    <a href="#" class="mobile-menu-link">ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</a>
                    <a href="#" class="mobile-menu-link">ğŸ‡«ğŸ‡· FranÃ§ais</a>
                </div>
            </div>
        </div>
    </header>

    <main>
        <h2>Your Basket</h2>
        {% if items %}
        <div class="basket-items">
            {% for item_key, item in items.items() %}
            <div class="basket-item">
                <img src="{{ item.product.image }}" alt="{{ item.product.name }}">
                <div class="item-details">
                    <h3>{{ item.product.name }}</h3>
                    <p>{{ item.product.description }}</p>
                    <p>Price: ${{ "%.2f"|format(item.product.price) }} each</p>
                    <form action="{{ url_for('update_basket', product_id=item_key) }}" method="POST" class="update-form">
                        <label>Quantity:</label>
                        <input type="number" name="quantity" value="{{ item.quantity }}" min="1" max="50">
                        {% if item.quantity >= 10 %}
                        <p style="color: #663200;"><strong>10% Discount Applied!</strong></p>
                        {% else %}
                        <p class="discount-note">Buy 10+ for 10% discount</p>
                        {% endif %}
                        <button type="submit" class="btn-secondary">Update</button>
                    </form>
                    <p><strong>Total for this item: ${{ "%.2f"|format(item.total) }}</strong></p>
                    <a href="{{ url_for('remove_from_basket', product_id=item_key) }}" class="remove-link">Remove</a>
                </div>
            </div>
            {% endfor %}
        </div>
        <div class="basket-total">
            <h3>Total: ${{ "%.2f"|format(total) }}</h3>
            <a href="{{ url_for('checkout') }}" class="btn-primary">Proceed to Checkout</a>
        </div>
        {% else %}
        <p>Your basket is empty. <a href="{{ url_for('products') }}">Browse our pastries</a></p>
        {% endif %}
    </main>

    <footer>
        <p>&copy; 2025 Mediterranean Sweets. All rights reserved.</p>
    </footer>

    <script src="{{ url_for('static', filename='js/scripts.js') }}"></script>
</body>
</html>
